<div class="breadcrumb-list"
     fxLayout="row"
     fxLayout.lt-lg="column"
     fxFlexFill>

  <div fxLayout="row"
       fxLayout.gt-lg="column">
    <div fxFlex="auto" class="logo">
      <app-logo></app-logo>
    </div>
  </div>

  <div fxLayout="column" fxFill>

    <div fxLayout="row" fxLayout.lt-lg="column" class="breadcrumb-row">

      <!-- SEARCH TYPE -->
      <div fxFlex="nogrow" fxFlex.lt-lg="auto" class="breadcrumb">
        <mat-form-field fxFlex.lt-lg="auto">
          <mat-label>Search Type</mat-label>
          <mat-select
            [(ngModel)]="searchType"
            (selectionChange)="onSetSearchType($event.value)">
            <mat-option [value]="searchTypes.DATASET">Geographic</mat-option>
            <mat-option [value]="searchTypes.LIST">List</mat-option>
            <mat-option [value]="searchTypes.MISSION">Mission</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- GEOGRAPHIC SEARCH FILTERS -->
      <ng-container *ngIf="searchType === searchTypes.DATASET">

        <!-- DATASET FILTER -->
        <div fxFlex="nogrow" fxFlex.lt-lg="100" (click)="clearSelectedBreadcrumb()"
             class="breadcrumb">
          <app-dataset-selector></app-dataset-selector>
        </div>

        <!-- AOI FILTER -->
        <form #polygonForm="ngForm"
          fxFlex="nogrow" class="breadcrumb"
          (mouseenter)="isHoveringAOISelector = true"
          (mouseleave)="isHoveringAOISelector = false"
          (keydown.enter)="$event.preventDefault()">

          <mat-form-field
            [class.invalid-input-animation]="isAOIError"
            class="full-width">
            <label>
              <input
                (change)="onInputSearchPolygon($event.target.value)"
                [value]="polygon"
                [(ngModel)]="polygon"
                name="searchPolygon"
                matInput placeholder="Area of Interest">
            </label>

            <mat-icon
              *ngIf="!!polygon && isHoveringAOISelector" (click)="onCopy()"
              matTooltip="Copy to clipboard"
              class="clickable copy-icon" matSuffix>
                file_copy
            </mat-icon>
            <mat-icon
              (click)="onNewSelectedFilter(filterTypes.AOI)"
              matTooltip="More options"
              class="clickable additional-aoi-toggle"
              matSuffix>
              {{ selectedFilter === filterTypes.AOI ? 'arrow_drop_up' : 'arrow_drop_down' }}
            </mat-icon>
          </mat-form-field>

          <mat-card *ngIf="selectedFilter === filterTypes.AOI"
                    class="breadcrumb-filter">
            <app-aoi-upload></app-aoi-upload>
          </mat-card>
        </form>

        <!-- DATES START/END FILTER -->
        <div fxFlex="nogrow" class="breadcrumb">
          <app-date-selector></app-date-selector>
        </div>
        <button (click)="onToggleFiltersMenu()"
                mat-button class="additional-filters-button">
          More<br>Filters
          <br>
          <mat-icon>more_horiz</mat-icon>
        </button>

      </ng-container>

      <!-- ADDITIONAL FILTERS -->
      <div fxFlex="nogrow" class="breadcrumb additional-filters">
        <div *ngIf="searchType !== searchTypes.DATASET">
          <button (click)="onToggleFiltersMenu()"
                  *ngIf="searchType !== searchTypes.DATASET"
                  mat-flat-button
                  class="search-dialog-button">
            <span *ngIf="searchType === searchTypes.MISSION">Select Mission</span>
            <span *ngIf="searchType === searchTypes.LIST">
              <mat-icon>edit</mat-icon>
              Edit List
            </span>
          </button>
        </div>
      </div>

      <div fxFlex class="breadcrumb extra-padding-top">
        <button (click)="onDoSearch()"
                [disabled]="!(canSearch$ | async) && !(isMaxResultsLoading$ | async) "
                mat-flat-button color="primary">
          {{
            (loading$ | async) ?
              'LOADING...' :
              (!(canSearch$ | async) && !(isMaxResultsLoading$ | async) ?
                'NO RESULTS' : 'SEARCH')
          }}
        </button>
        <mat-icon
          (click)="onClearSearch()"
          matTooltip="Clear search filters"
          class="clear-search-icon">
          clear
        </mat-icon>
      </div>
    </div>

    <div fxLayout="row wrap"
         fxFlexFill
         class="info-bar">

      <div fxFlex.gt-md="550px" class="first-info">
      </div>
      <div fxFlex="300px" class="max-results">
          <app-max-results-selector
            [maxResults]="maxResults$ | async"
            [isMaxResultsLoading]="isMaxResultsLoading$ | async"
            [currentSearchAmount]="currentSearchAmount$ | async"
            (newMaxResults)="onNewMaxResults($event)"
          ></app-max-results-selector>
      </div>
      <div fxFlex="300px">
        <app-nav-buttons
          (openQueue)="onOpenDownloadQueue()"
          [queuedProducts]="queuedProducts$ | async">
        </app-nav-buttons>
      </div>
    </div>
  </div>
</div>
