<div class="processing-queue"
          cdkDrag
          cdkDragRootElement=".cdk-overlay-pane"
          [ngStyle]="style"
          mwlResizable
          [enableGhostResize]="true"
          [resizeEdges]="{ right: true, bottom: true }"
          (resizeEnd)="onResizeEnd($event)"
  >

      <mat-card-title-group class="card-title-group">
        <mat-card-title>
          <div class="on-demand-branding">
            <mat-icon
              class="on-demand-icon"
              svgIcon="hyp3"
              matBadgePosition="above after"
              matBadgeOverlap="true"
              matBadgeSize="small">
            </mat-icon>
          </div>
          <div class="on-demand-text">
            On Demand
            <div class="project-name">
              <app-project-name-selector [processName]="true">
              </app-project-name-selector>
            </div>
          </div>
          <div class="subtitle">
            powered by HyP3
          </div>
        </mat-card-title>
        <div class="dataset-menu">
          <span class="processing-type-text">Processing Type: </span>
          <button mat-flat-button color="primary" [matMenuTriggerFor]="menu_RTC">RTC</button>
          <mat-menu #menu_RTC="matMenu">
            <button mat-menu-item>Not Needed</button>
            <button mat-menu-item>But An Idea</button>
            <button mat-menu-item>Gamma</button>
            <button mat-menu-item>Beta</button>
          </mat-menu>
          <button mat-flat-button color="primary" [matMenuTriggerFor]="menu_2">InSAR</button>
          <mat-menu #menu_2="matMenu">
            <button mat-menu-item>Maybe Subsets</button>
            <button mat-menu-item>Or Variants</button>
          </mat-menu>
          <button mat-flat-button color="primary" [matMenuTriggerFor]="menu_3">Ragnarok</button>
          <mat-menu #menu_3="matMenu">
            <button mat-menu-item>Norse Legend</button>
            <button mat-menu-item>End of the World</button>
          </mat-menu>
          <button mat-flat-button color="primary" [matMenuTriggerFor]="menu_more">More&#8230;</button>
          <mat-menu #menu_more="matMenu">
            <button mat-menu-item>Processing Type 4</button>
            <button mat-menu-item>Processing Type 5</button>
            <button mat-menu-item>Processing Type 6</button>
            <button mat-menu-item>Processing Type 7</button>
            <button mat-menu-item>Processing Type 8</button>
          </mat-menu>
        </div>
      </mat-card-title-group>

      <div class="feedback-div feedback-link">
        <a href="javascript:feedback.showForm();" onfocus="this.blur()"> <i class="fa fa-comments-o"></i> Feedback</a>
      </div>

      <div class="close-x" (click)="onCloseDialog()">
          <mat-icon>close</mat-icon>
      </div>


  <mat-card-content>

        <div class="content-block">

            <div *ngIf="!isUserLoggedIn && !isUserLoading" class="w100 error-header">
              <div style="padding-left: 10px;">
                <b>Sign in to process data</b>
              </div>
              <div>
                <button (click)="onAccountButtonClicked()" color="primary" mat-flat-button>
                  Sign In
                  <mat-icon>account_circle</mat-icon>
                </button>
              </div>
            </div>

          <div class="content-top-area">
            <div class="jobs-detail">
              <app-processing-options></app-processing-options>
            </div>
          </div>

          <div class="content-bottom-area">
            <div class="bottom-item">
                <!-- PRODUCT LIST AREA STARTS HERE -->
                <mat-card-content class="mat-card-content-2">
                  <div class="jobs-dialog">

                    <div *ngIf="isUserLoggedIn && !isUserLoading && jobs.length > remaining " class="w100 error-header">
                      <div style="padding-left: 10px;">
                        <b>Too many jobs in queue </b>
                      </div>
                      <div style="padding: 7px 10px;">
                        <b>({{ jobs.length - remaining }} extra job{{ (jobs.length - remaining) === 1 ? '' : 's'  }})</b>
                      </div>
                    </div>

                    <div *ngIf="isUserLoggedIn && !isUserLoading && remaining === 0" class="w100 error-header">
                      <div style="padding-left: 10px;">
                        <b>No jobs left this month</b>
                      </div>
                      <div>
                        <button (click)="onCloseDialog()" mat-flat-button>
                          <mat-icon>close</mat-icon>
                        </button>
                      </div>
                    </div>

                    <div *ngIf="breakpoint !== breakpoints.MOBILE" class="jobs-display--desktop">
                      <div class="jobs-list-panel">
                        <app-processing-queue-jobs
                          [jobs]="jobs"
                          [areJobsLoading]="areJobsLoading"
                          (removeJob)="onRemoveJob($event)">
                        </app-processing-queue-jobs>
                      </div>

                    </div>

                    <div *ngIf="breakpoint === breakpoints.MOBILE">
                      <div class="mobile-tab-selector">
                        <button (click)="onSelectScenesTab()"
                                [class.selected]="selectedTab === Tabs.SCENES" mat-button>
                          Scenes
                        </button>
                        <button (click)="onSelectOptionsTab()"
                                [class.selected]="selectedTab === Tabs.OPTIONS" mat-button>
                          Processing Options
                        </button>
                      </div>
                      <div *ngIf="selectedTab === Tabs.SCENES" class="jobs-display--mobile">
                        <app-processing-queue-jobs
                          [jobs]="jobs"
                          [areJobsLoading]="areJobsLoading"
                          (removeJob)="onRemoveJob($event)">
                        </app-processing-queue-jobs>
                      </div>
                      <div *ngIf="selectedTab === Tabs.OPTIONS" class="jobs-display--mobile">
                        <app-processing-options></app-processing-options>
                      </div>
                    </div>

                    <mat-progress-bar *ngIf="isQueueSubmitProcessing" mode="indeterminate"></mat-progress-bar>

                  </div>
                </mat-card-content>
            </div>
          </div>

        </div>

      </mat-card-content>

      <mat-card-footer>
        <div class="w100 hyp3-footer">

          <div class="footer-clear">

            <button *ngIf="previousQueue === null"
                    (click)="onClearJobQueue(jobs)"
                    mat-button>
              <mat-icon>delete</mat-icon>
              <span>Clear</span>
            </button>

            <button *ngIf="previousQueue !== null"
                    (click)="onRestoreJobQueue(previousQueue)"
                    mat-flat-button
                    color="primary"
                    class="footer-clear-button">
              <mat-icon>undo</mat-icon>
              <span>Restore</span>
            </button>

          </div>

          <div class="footer-job-notification">
            <div *ngIf="isUserLoggedIn && !isUserLoading && user !== ''">
              <span *ngIf="breakpoint === breakpoints.MOBILE">
                {{ remaining }} job max
              </span>
              <span *ngIf="breakpoint !== breakpoints.MOBILE">
               {{ remaining }} jobs left this month
              </span>
            </div>
            <div *ngIf="isUserLoggedIn && isUserLoading">
              <b>Loading...</b>
            </div>
            <div *ngIf="!isUserLoggedIn">
              <span *ngIf="breakpoint === breakpoints.MOBILE">
               <b>N/A</b> - login to view
              </span>
              <span *ngIf="breakpoint !== breakpoints.MOBILE">
                <b>N/A</b> - login to view number of jobs left this month
              </span>
            </div>
          </div>

          <div class="footer-submit">
            <button
              (click)="onSubmitQueue()"
              [disabled]="
                jobs.length > remaining ||
                jobs.length === 0 ||
                !isUserLoggedIn
              "
              mat-flat-button
              color="primary"
              class="footer-submit-button"
            >
            <span *ngIf="!isQueueSubmitProcessing">
              Submit {{ jobs.length }} Job<span *ngIf="jobs.length > 1">s</span>
            </span>

              <span *ngIf="isQueueSubmitProcessing">
              Loading...
            </span>
            </button>
          </div>

        </div>
      </mat-card-footer>

</div>
