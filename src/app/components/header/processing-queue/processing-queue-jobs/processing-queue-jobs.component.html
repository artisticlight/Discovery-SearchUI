<div class="jobs-list">
  <ng-container *ngIf="jobs[0].job_type.name === 'RTC GAMMA'; else elsePair">
  <mat-list *ngIf="!areJobsLoading" role="list" class="flex-list">
    <ng-container
      *ngIf="jobs.length > 0 ; then jobsQueued; else emptyQueue">
    </ng-container>

    <ng-template #jobsQueued>
      
      <mat-list-item *ngFor="let job of jobs" class="job-list-item">
          <img matListAvatar
               [src]="job.granules[0].thumbnail"
               onerror="this.src='assets/no-thumb.png'"
               matBadgeOverlap="false"
               matListAvatar>

          <div matLine class="granule-name">
            {{ job.granules[0].name }}
          </div>

          <div *ngIf="job.job_type.name === 'RTC GAMMA'" matLine>
            <b>
              {{ job.job_type.name }}
            </b>
            <b>
              <span *ngIf="job.granules[0].bytes === 0">Virtual</span>
              <span *ngIf="job.granules[0].bytes !== 0">{{ job.granules[0].bytes | readableSizeFromBytes }}</span>
            </b>
          </div>
          <div *ngIf="job.job_type.name !== 'RTC GAMMA'" style="font-size: 14px;" matLine>
          {{job.granules[1].name}}
          </div>

          <div class="button-remove-job">
            <button (click)="onRemoveJob(job)"
                    matTooltip="Remove job"
                    mat-icon-button>
              <mat-icon>close</mat-icon>
            </button>
          </div>
      </mat-list-item>

    </ng-template>

    <ng-template #emptyQueue>
      <div class="empty-queue">
        <div class="jobs-empty-message">
          Your jobs queue is empty.
        </div>
        <div class="jobs-empty-message-docs-link">
          <a href="https://hyp3-docs.asf.alaska.edu/" target="_blank">
            On Demand (HyP3) Documentation
          </a>
        </div>
      </div>

      <div class="jobs-search">
        <button [disabled]="!isLoggedIn"
                (click)="viewCustomProducts($event)" color="primary" mat-flat-button>
          View Submitted Jobs
        </button>
        <p class="not-logged-in" *ngIf="!isLoggedIn">Sign in to view submitted jobs</p>
      </div>
    </ng-template>
  </mat-list>
  </ng-container>
</div>


<ng-template #elsePair class="jobs-list">
  <div *ngIf="!areJobsLoading">
    <ng-container
      *ngIf="jobs.length > 0 ; then jobsQueued; else emptyQueue">
    </ng-container>

    <ng-template #jobsQueued>
      
      <mat-accordion *ngFor="let job of jobs" style="width: 100%; padding-top: 8px">
        <mat-expansion-panel class="mat-elevation-z0" style="padding-left: 16px;">
              <mat-expansion-panel-header class="pair-expansion-panel-header" [collapsedHeight]="'58px'">
      <mat-panel-title>
        
        <img style="
        width: 40px;
        height: 40px;
        border-radius: 6px !important;"
        [src]="job.granules[0].thumbnail"
        onerror="this.src='assets/no-thumb.png'"
        matBadgeOverlap="false"
        >


      </mat-panel-title>
      
      <mat-panel-description style="color: black !important;">
        <div style="display: block;">
          <span class="granule-name">
            {{ job.granules[0].name }}
          </span>
          <div style="float: right;">
            <button (click)="onRemoveJob(job)"
                    matTooltip="Remove job"
                    mat-icon-button>
              <mat-icon>close</mat-icon>
            </button>
          </div>
           <br>
          <span>
            <b>
            {{ job.job_type.name }}
            <span *ngIf="job.granules[0].bytes === 0">Virtual</span>
            <span *ngIf="job.granules[0].bytes !== 0">{{ job.granules[0].bytes | readableSizeFromBytes }}</span>
          </b>         
        </span>
      </div>
      </mat-panel-description>
          </mat-expansion-panel-header>

          <div style="margin-top: 5px !important;">
        <ng-container *ngFor="let granule of job.granules; let idx = index">
          <div style="display: flex; margin-left: 25px;">
            <div *ngIf="idx ===0">Primary: 
              <div style="margin-left: 25px;">
                {{granule.name}}
                <app-copy-to-clipboard
                [value]="granule.name"
                prompt="Copy primary scene name"
                class="clipboard-icon"></app-copy-to-clipboard>
              </div>
            </div>
            <div *ngIf="idx > 0">Secondary: 
              <div style="margin-left: 25px;">
                {{granule.name}}
                <app-copy-to-clipboard
                [value]="granule.name"
                prompt="Copy secondary scene name"
                class="clipboard-icon"></app-copy-to-clipboard>
              </div>
            </div>
        </div>
        </ng-container>
      </div>
        </mat-expansion-panel>
      </mat-accordion>
    </ng-template>

    <ng-template #emptyQueue>
      <div class="empty-queue">
        <div class="jobs-empty-message">
          Your jobs queue is empty.
        </div>
        <div class="jobs-empty-message-docs-link">
          <a href="https://hyp3-docs.asf.alaska.edu/" target="_blank">
            On Demand (HyP3) Documentation
          </a>
        </div>
      </div>

      <div class="jobs-search">
        <button [disabled]="!isLoggedIn"
                (click)="viewCustomProducts($event)" color="primary" mat-flat-button>
          View Submitted Jobs
        </button>
        <p class="not-logged-in" *ngIf="!isLoggedIn">Sign in to view submitted jobs</p>
      </div>
    </ng-template>
  </div>
  </ng-template>










