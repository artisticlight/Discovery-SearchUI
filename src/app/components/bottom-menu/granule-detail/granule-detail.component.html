<div *ngIf="granule">
  <mat-card-header>
    <mat-card-title>
      <span [title]="granule.name">{{ granule.name | truncate : 34 }}</span>
      <app-copy-to-clipboard style="margin: 0 10px; " [value]="granule.name"></app-copy-to-clipboard>

      <button (click)="onZoomToGranule()"
        matTooltip="Zoom to granule" mat-icon-button>
        <mat-icon>settings_overscan</mat-icon>
      </button>

    </mat-card-title>
    <mat-card-subtitle>
      <span matTooltip="Dataset">{{ granule.platform }}</span> â€¢
      <span matTooltip="Frequency">{{ platform.frequency }}</span>
    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <div class="w100" fxFlex fxLayout="row" fxLayoutAlign="space-between">
      <div style="width: 50%">
        <ul class="granule-metadata">
          <li *ngIf="hasValue(granule.metadata.date)">
            <span class="v-mid"><b>Aquisition Date:</b> {{ granule.metadata.date | shortDate }}</span>
            <mat-icon *ngIf="isGeoSearch()"
              [matMenuTriggerFor]="addGranuleDateMenu"
              matTooltip="Add date to search"
              class="v-mid clickable">
                add
            </mat-icon>

            <mat-menu #addGranuleDateMenu="matMenu">
              <button (click)="setStartDate()" mat-menu-item>Start Date</button>
              <button (click)="setEndDate()" mat-menu-item>End Date</button>
            </mat-menu>
          </li>

          <li *ngIf="hasValue(granule.metadata.beamMode)">
              <span class="v-mid"><b>Beam Mode:</b> {{ granule.metadata.beamMode }}</span>
              <mat-icon *ngIf="isGeoSearch()"
                (click)="onSetBeamMode()"
                matTooltip="Add {{ granule.metadata.beamMode }} to search"
                class="v-mid clickable">
                  add
              </mat-icon>
          </li>

          <li *ngIf="hasValue(granule.metadata.path) && !shouldHideWith(['SMAP'])">
            <b>Path: </b> {{ granule.metadata.path }}
          </li>
          <li *ngIf="hasValue(granule.metadata.frame) && !shouldHideWith(['SMAP'])">
            <b>Frame:</b> {{ granule.metadata.frame }}
          </li>
          <li *ngIf="hasValue(granule.metadata.flightDirection)">
            <b>Flight Direction:</b> {{ granule.metadata.flightDirection }}
          </li>

          <li *ngIf="hasValue(granule.metadata.polarization)">
            <b>Polarization: </b> {{ granule.metadata.polarization }}
          </li>
          <li *ngIf="hasValue(granule.metadata.absoluteOrbit)">
            <b>Absolute Orbit: </b> {{ granule.metadata.absoluteOrbit }}
          </li>
          <li> <a href="http://www.esa.int/ESA" target="_blank"> Data courtesy of ESA</a></li>
        </ul>

        <p *ngIf="!authService.isLoggedIn" class="faint-text">
          Accessing this data requires you to log in.
          Some datasets also require a proposal, or agreement with a
          EULA which is presented after log in.
        </p>

      </div>
      <div class="clickable" fxFlexAlign="center" style="width: 40%;">
        <div (click)="onOpenImage(granule);"
          class="img-container">
            <img
              class="browse-img fit-to-container"
              [src]="granule.browse"
              style="cursor: pointer; "
              onerror="this.src='assets/error.png'"
              alt="Sentinel1 granule browse image">
            <div class="img-overlay fit-to-container">
              <mat-icon class="overlay-icon">fullscreen</mat-icon>
            </div>
        </div>
      </div>
    </div>
  </mat-card-content>

  <mat-card-actions>
    <a mat-raised-button color="primary"
      target="_blank"
      href="https://baseline.asf.alaska.edu/#/baseline?granule={{ granule.name }}">
      Baseline Tool
    </a>
    <a mat-raised-button color="primary"
      target="_blank"
      href="https://www.asf.alaska.edu/about/how-to-cite-data/">
      Citation
    </a>
  </mat-card-actions>
</div>

<div *ngIf="!granule" style="height: 100%;">
  <div fxFlex fxLayoutAlign="center" gdAlignColumns="center">
    <span class="faint-text">No Granule Selected</span>
  </div>
</div>
