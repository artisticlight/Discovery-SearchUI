<div
  [@changeMenuY]="(isBottomMenuOpen$ | async) ? 'shown' : 'hidden'"
  [class.hidden]="(isHidden$ | async) || (areNoGranules$  | async)"
  class="bottom-menu-wrapper">
  <div class="toggle-button-position">
    <button (click)="onToggleMenu()"
       class="toggle-button"
      mat-flat-button>
      <span>Results</span>
      <mat-icon>
        {{ (isBottomMenuOpen$ | async) ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}
      </mat-icon>
    </button>
  </div>
  <div class="bottom-menu--background  bottom-menu--layout"
       fxLayout="row"
       fxLayout.lt-md="column">
    <mat-card class="card-spacing bottom-menu--column"
        fxFlex="33" fxFlexFill>
      <mat-card-subtitle *ngIf="numberOfGranules$ | async as numberOfGranules" class="header">
        <div style="display: flex; justify-content: center">
          <div style="margin-right: 10px;">
            {{ numberOfGranules }} Scene{{ numberOfGranules === 1 ? '' : 's' }}
            ({{ numberOfProducts$ | async }} of {{ formatNumber(totalResultCount$ | async) }} File{{ (numberOfProducts$ | async) === 1 ? '' : 's' }})
          </div>
          <div *ngIf="allProducts$ | async as products">
            <mat-icon
               class="clickable noselect"
               matTooltip="Add all results to queue"
              [matMenuTriggerFor]="addAllProducts">
                add_shopping_cart
            </mat-icon>

            <mat-menu #addAllProducts="matMenu">
              <button (click)="queueAllProducts(products)" mat-menu-item>
                Add {{ products.length }} file{{ products.length === 1 ? '' : 's'}} to queue
              </button>
            </mat-menu>
          </div>
        </div>
      </mat-card-subtitle>
      <div class="app-granule-list">
        <app-granules-list>
        </app-granules-list>
      </div>
    </mat-card>

    <mat-card class="card-spacing bottom-menu--column"
              fxFlex="34" fxFlexFill>
      <mat-card-subtitle class="header">
        Scene Detail
      </mat-card-subtitle>
      <app-granule-detail>
      </app-granule-detail>
    </mat-card>

    <mat-card class="card-spacing bottom-menu--column"
              fxFlex="33" fxFlexFill>
      <mat-card-subtitle class="header">
        <span *ngIf="selectedProducts$ | async as products; else defaultProductsHeader">
          {{ products.length || '' }} File{{ (products || []).length === 1 ? '' : 's'}}
        </span>
        <ng-template #defaultProductsHeader>Files</ng-template>
      </mat-card-subtitle>
      <app-products
        [products]="selectedProducts$ | async"
        [queuedProductIds]="queuedProductIds$ | async"
        (toggleQueueProduct)="onToggleQueueProduct($event)"
        ></app-products>
    </mat-card>
  </div>
</div>
