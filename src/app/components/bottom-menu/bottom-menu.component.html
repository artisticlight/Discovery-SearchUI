
<div
  [@changeMenuY]="(isBottomMenuOpen$ | async) ? 'shown' : 'hidden'"
  [@changeMenuX]="(isSideMenuOpen$ | async) ? 'full-width' : 'half-width'"
  [ngClass]="{'hidden': isHidden || (granules$ | async).length === 0}"
  class="position">
  <div class="bottom-menu--background  bottom-menu--layout">
    <app-granules-list
      class="scrollable-card bottom-menu--column"
      (newFocusedGranule)="onNewFocusedGranule($event)"
      (clearFocusedGranule)="onClearFocusedGranule()"
      (newSelected)="onNewGranuleSelected($event)"
      (queueGranule)="onQueueGranuleProducts($event)"
      [granules]="granules$ | async"
      [selected]="(selectedGranule$ | async)?.name">
    </app-granules-list>

    <mat-card class="card-spacing bottom-menu--column">
      <mat-selection-list *ngIf="selectedProducts$ | async as products">
        <h3 mat-subheader>Granule Products</h3>
        <mat-list-option *ngFor="let product of products">
          <span *ngIf="product.file.length > 29">
            <b>{{ product.file | truncate : 25 }}{{ product.file | truncate : -4 : '' }}</b>
          </span>
          <span *ngIf="product.file.length <= 29">
            <b>{{ product.file }}</b>
          </span>
        </mat-list-option>
      </mat-selection-list>
    </mat-card>

    <mat-card class="card-spacing bottom-menu--column">
      <ng-container *ngIf="selectedGranule$ | async as granule">
        <mat-card-header>
          <mat-card-title [title]="granule.name">{{ granule.name | truncate : 21 }}</mat-card-title>
          <mat-card-subtitle>{{ granule.platform }}</mat-card-subtitle>
        </mat-card-header>

        <img mat-card-image
          [src]="granule.browse"
          (click)="onOpenImage(granule);"
          style="cursor: pointer"
          onerror="this.src='assets/error.png'"
          alt="Sentinel1 granule browse image">
            </ng-container>
    </mat-card>
  </div>

  <button class="toggle-button" mat-raised-button (click)="onToggleMenu()">
    <mat-icon>{{ (isBottomMenuOpen$ | async) ? 'expand_more' : 'expand_less' }}</mat-icon>
  </button>
</div>
