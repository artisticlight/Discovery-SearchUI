<div
  [@changeMenuState]="(isSidebarOpen$ | async) ? 'shown' : 'hidden'"
  class="position ">

<app-toggle-button
  (click)="onToggleHide()"
  [isOpen]="isSidebarOpen$ | async">
</app-toggle-button>

<div class="filter-list "><div>
  <div
    *ngIf="error$ | async" class="m-2 alert alert-danger" role="alert">
    {{ error$ | async }}
  </div>


  <app-filter-selector
    [selectedFilter]="selectedFilter$ | async"
    (newFilterSelected)="onNewFilterSelected($event)">
  </app-filter-selector>

  <app-search-bar
    (newSearch)="onNewSearch()"
    (clearSearches)="onClearSearch()"
    [isLoading]="loading$ | async">
  </app-search-bar>

  <ng-container *ngIf="selectedFilter$ | async as selected">
    <app-platform-selector
      *ngIf="selected === filterType.PLATFORM"
      [platforms]="platforms$ | async"
      [selected]="selectedPlatformNames$ | async"
      (removeSelected)="onPlatformRemoved($event)"
      (addSelected)="onPlatformAdded($event)">
    </app-platform-selector>

    <app-date-selector
      *ngIf="selected === filterType.DATE"
      [startDate]="startDate$ | async"
      [endDate]="endDate$ | async"
      [extrema]="dateRangeExtrema$ | async"
      (newStart)="onNewStartDate($event)"
      (newEnd)="onNewEndDate($event)">
    </app-date-selector>

    <app-path-selector
      *ngIf="selected === filterType.PATH"
      (newPathStart)="onNewPathStart($event)"
      (newPathEnd)="onNewPathEnd($event)"
      (newFrameStart)="onNewFrameStart($event)"
      (newFrameEnd)="onNewFrameEnd($event)"
      (newOmitSearchPolygon)="onNewOmitGeoRegion($event)"
      [pathRange]="pathRange$ | async"
      [shouldOmitSearchPolygon]="shouldOmitSearchPolygon$ | async"
      [frameRange]="frameRange$ | async"
      [selected]="selectedPlatforms$ | async">
    </app-path-selector>

    <app-other-selector
      *ngIf="selected === filterType.OTHER"
      [selected]="selectedPlatforms$ | async">
    </app-other-selector>
  </ng-container>

  <ng-container *ngIf="selectedGranule$ | async as selected">
    <app-product-detail
        *ngIf="!!selected"
        [product]="selected">
    </app-product-detail>
  </ng-container>

  <ng-container *ngIf="granules$ | async as granules">
    <app-products-list
      *ngIf="granules.length > 0"
      [products]="granules"
      [selected]="(selectedGranule$ | async)?.name"
      (newSelected)="onNewProductSelected($event)">
    </app-products-list>
  </ng-container>

</div></div>
</div>
