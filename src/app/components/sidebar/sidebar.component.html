<div
  [@changeMenuState]="(isSidebarOpen$ | async) ? 'shown' : 'hidden'"
  class="position ">

<app-toggle-button
  (click)="onToggleHide()"
  [isOpen]="isSidebarOpen$ | async">
</app-toggle-button>

<div class="filter-list">

  <div class="top-list-elements">
    <app-logo
       class="clickable"
      (click)="onAppReset()">
    </app-logo>

    <app-search-selector
      (newSearchType)="onSetSearchType($event)"
      [selectedSearchType]="searchType$ | async">
    </app-search-selector>

    <mat-card *ngIf="searchError$ | async as error" class="card-spacing">
      <b>Error:</b> {{error}}
    </mat-card>
  </div>

  <div class="filters-scoll">

  <mat-tab-group
    *ngIf="selectedSearchType !== null"
    [selectedIndex]="selectedTab"
    (selectedIndexChange)="onTabChange($event)"
    >
    <mat-tab label="Search">
      <app-search></app-search>
    </mat-tab>

    <ng-container *ngIf="granules$ | async as granules">
      <mat-tab
        *ngIf="granules.length > 0"
        label="Results">

        <ng-container *ngIf="selectedGranule$ | async as selected">
          <app-granule-detail
              *ngIf="!!selected"
              (newFocusedGranule)="onNewFocusedGranule($event)"
              (clearFocusedGranule)="onClearFocusedGranule($event)"
              (newQueueItem)="onNewQueueItem($event)"
              (newQueueItems)="onNewQueueItems($event)"
              [granule]="selected"
              [products]="selectedProducts$ | async">
          </app-granule-detail>
        </ng-container>

        <mat-card class="card-spacing">
          <button (click)="onOpenSpreadsheet()" mat-raised-button>Open Spreadsheet</button>
        </mat-card>

        <app-granules-list
          (newFocusedGranule)="onNewFocusedGranule($event)"
          (clearFocusedGranule)="onClearFocusedGranule($event)"
          (newSelected)="onNewGranuleSelected($event)"
          (queueGranule)="onQueueGranuleProducts($event)"
          [granules]="granules"
          [selected]="(selectedGranule$ | async)?.name">
        </app-granules-list>
      </mat-tab>
    </ng-container>
  </mat-tab-group>
  </div>
  <div *ngIf="selectedSearchType !== null && selectedTab === 0" class="bottom-list-elements">
    <app-search-bar
      (newSearch)="onNewSearch()"
      (clearSearches)="onClearSearch()"
      [isLoading]="loading$ | async">
    </app-search-bar>
  </div>
</div>
</div>
