<div
  [@changeMenuState]="(isSidebarOpen$ | async) ? 'shown' : 'hidden'"
  class="position ">

<app-toggle-button
  (click)="onToggleHide()"
  [isOpen]="isSidebarOpen$ | async">
</app-toggle-button>

<div class="filter-list "><div>
  <app-search-bar
    (newSearch)="onNewSearch()"
    (clearSearches)="onClearSearch()"
    [isLoading]="loading$ | async">
  </app-search-bar>

  <mat-tab-group color="primary" backgroundColor="primary">
    <mat-tab label="List Search">
      <app-list-search
        (newListSearchMode)="onNewListSearchMode($event)"
        (newListSearch)="onNewGranuleList($event)"
        [mode]="listSearchMode$ | async"
        [searchList]="searchList$ | async"
        ></app-list-search>
    </mat-tab>

    <mat-tab label="Filters">
      <app-platform-selector
        [platforms]="platforms$ | async"
        [selected]="selectedPlatformNames$ | async"
        (removeSelected)="onPlatformRemoved($event)"
        (addSelected)="onPlatformAdded($event)">
      </app-platform-selector>

      <app-date-selector
        [startDate]="startDate$ | async"
        [endDate]="endDate$ | async"
        [extrema]="dateRangeExtrema$ | async"
        (newStart)="onNewStartDate($event)"
        (newEnd)="onNewEndDate($event)">
      </app-date-selector>

      <app-path-selector
        (newPathStart)="onNewPathStart($event)"
        (newPathEnd)="onNewPathEnd($event)"
        (newFrameStart)="onNewFrameStart($event)"
        (newFrameEnd)="onNewFrameEnd($event)"
        (newOmitSearchPolygon)="onNewOmitGeoRegion($event)"
        [pathRange]="pathRange$ | async"
        [shouldOmitSearchPolygon]="shouldOmitSearchPolygon$ | async"
        [frameRange]="frameRange$ | async"
        [selected]="selectedPlatforms$ | async">
      </app-path-selector>

      <app-other-selector
        [selected]="selectedPlatforms$ | async">
      </app-other-selector>
    </mat-tab>

    <ng-container *ngIf="granules$ | async as granules">
      <mat-tab
        *ngIf="granules.length > 0"
        label="Results">
        <ng-container *ngIf="selectedGranule$ | async as selected">
          <app-product-detail
              *ngIf="!!selected"
              (newQueueItem)="onNewQueueItem($event)"
              [granule]="selected"
              [products]="selectedProducts$ | async">
          </app-product-detail>
        </ng-container>

          <app-products-list
            *ngIf="granules.length > 0"
            [products]="granules"
            [selected]="(selectedGranule$ | async)?.name"
            (newSelected)="onNewProductSelected($event)">
          </app-products-list>
      </mat-tab>
    </ng-container>

    <ng-container *ngIf="queueProducts$ | async as queue">
      <mat-tab
        *ngIf="queue.length > 0"
        label="Queue">
          <app-queue
            (itemRemoved)="onRemoveItem($event)"
            (clear)="onClearQueue()"
            [products]="queue">
          </app-queue>
      </mat-tab>
    </ng-container>
  </mat-tab-group>
  </div></div>

</div>
