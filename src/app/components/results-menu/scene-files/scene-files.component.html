<div *ngIf="showDemWarning" class="dem-warning">
  Resampled DEM (SRTM or NED) used for RTC processing.
  <a class="more-link"
     target="_blank"
     href="https://asf.alaska.edu/data-sets/derived-data-sets/alos-palsar-rtc/alos-palsar-radiometric-terrain-correction/#DEM_Information">
    More...
  </a>
</div>

<div *ngIf="!showUnzippedProductScreen">
  <mat-list class="products-list">
    <app-scene-file *ngFor="let product of products"
      (toggle)="onToggleQueueProduct(product)"
      (unzip)="onOpenUnzipProduct($event)"
      (queueHyp3Job)="onQueueHyp3Job($event)"
      [loadingHyp3JobName]="loadingHyp3JobName"
      [isUserLoggedIn]="isUserLoggedIn"
      [product]="product"
      [validHyp3JobTypes]="validJobTypesByProduct[product.id]"
      [hasAccessToRestrictedData]="hasAccessToRestrictedData"
      [isUnzipLoading]="unzippedLoading === product.id"
      [isQueued]="(queuedProductIds$ | async).has(product.id)"
      [isOpen]="false">
    </app-scene-file>
  </mat-list>
</div>
  <div *ngIf="selectedSarviewEventID && !!sarviewsProducts" style="height: 100%; display: flex; flex-direction: column;">
    <div style="width: 100%; display: flex; flex-direction: row; justify-content: space-evenly; margin-bottom: 10px;">
        <mat-button-toggle-group fxFlex="" name="eventProductMapButton"
                                 class="criteria-button-group"
                                 (click)="onOpenPinnedProducts()">
          <mat-button-toggle class="control-mat-button-toggle map-button-toggle"
          matTooltip="View selected products on map">
            Event Products Map<mat-icon class="map-icon">map</mat-icon>
          </mat-button-toggle>
        </mat-button-toggle-group>
    </div>

    <div style="height: 100%; width: 100%;">
      <mat-selection-list multiple
      (selectionChange)="onSelectSarviewsProduct($event)"
      class="products-list" dense role="list" style="height: calc(100% - 58px);">
        <cdk-virtual-scroll-viewport [itemSize]="58" style="height: 100%;">
          <mat-list-option [value]="prod.product_id" [selected]="!!this.selectedProducts[prod.product_id]" checkboxPosition="before" class="virtual-scroll" *cdkVirtualFor="let prod of sarviewsProducts"
          style="margin-right: 0 !important; height: 58px !important;">
            <div class="sarview-products-list">
              <img style="width: 50px; height: 50px;" src="{{prod.files.browse_url}}">
              <div class="sarview-product">
                <div style="font-weight: bold;">{{formatProductName(prod.files.product_name)}}</div>
                <div>{{prod.files.product_size.toString() | readableSizeFromBytes }}, {{prod.job_type.replace("_", " ")}}</div>
              </div>
              <div></div>
              <div *ngIf="hyp3ableByProduct[prod.product_id] as byJobType">
                <button mat-icon-button
                (click)="$event.stopPropagation()"
                [matMenuTriggerFor]="EventOnDemandQueue.addMenu"
                [matMenuTriggerData]="{ hyp3able: byJobType }"
                >
                  <mat-icon class="list-icon"
                    svgIcon="hyp3">
                  </mat-icon>
              </button>
                <button mat-icon-button (click)="onQueueSarviewsProduct(prod); $event.stopPropagation();"><mat-icon *ngIf="!queuedProductIds.includes(prod.product_id)">add_shopping_cart</mat-icon>
                  <mat-icon *ngIf="queuedProductIds.includes(prod.product_id)">shopping_cart</mat-icon>
                </button>
                <button
                mat-icon-button
                (click)="downloadProduct(prod.files.product_url); $event.stopPropagation();"
                ><mat-icon>cloud_download</mat-icon></button>

                <app-on-demand-add-menu #EventOnDemandQueue>
                </app-on-demand-add-menu>
              </div>
          </div>
        </mat-list-option>
      </cdk-virtual-scroll-viewport>
      </mat-selection-list>
    </div>
  </div>

<div *ngIf="showUnzippedProductScreen" class="products-list zip-contents">
  <mat-list class="products-list">
    <app-scene-file
      *ngFor="let product of beforeWithUnzip"
      (toggle)="onToggleQueueProduct(product)"
      (unzip)="onOpenUnzipProduct($event)"
      (closeProduct)="onCloseProduct($event)"
      (queueHyp3Job)="onQueueHyp3Job($event)"
      [isUserLoggedIn]="isUserLoggedIn"
      [product]="product"
      [validHyp3JobTypes]="validJobTypesByProduct[product.id]"
      [loadingHyp3JobName]="loadingHyp3JobName"
      [hasAccessToRestrictedData]="hasAccessToRestrictedData"
      [isUnzipLoading]="unzippedLoading === product.id"
      [isQueued]="(queuedProductIds$ | async).has(product.id)"
      [isOpen]="product.id === openUnzippedProduct.id">
    </app-scene-file>
  </mat-list>
  <div>
    <app-file-contents>
    </app-file-contents>
  </div>
  <mat-list class="products-list">
    <app-scene-file
      *ngFor="let product of afterUnzip"
      (toggle)="onToggleQueueProduct(product)"
      (unzip)="onOpenUnzipProduct($event)"
      (closeProduct)="onCloseProduct($event)"
      (queueHyp3Job)="onQueueHyp3Job($event)"
      [isUserLoggedIn]="isUserLoggedIn"
      [product]="product"
      [loadingHyp3JobName]="loadingHyp3JobName"
      [hasAccessToRestrictedData]="hasAccessToRestrictedData"
      [validHyp3JobTypes]="validJobTypesByProduct[product.id]"
      [isUnzipLoading]="unzippedLoading === product.id"
      [isQueued]="(queuedProductIds$ | async).has(product.id)"
      [isOpen]="product.id === openUnzippedProduct.id">
    </app-scene-file>
  </mat-list>
</div>
