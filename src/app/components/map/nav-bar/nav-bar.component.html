<div
  [@changeMenuX]="isSideMenuOpen ? 'full-width' : 'half-width'"
  class="position">

  <div style="margin-left: 45px">
    <div class="breadcrumb-list" *ngIf="showFilters">
      <div class="breadcrumb">
        <button (click)="onNewSelectedFilter(filterTypes.DATASET)" mat-raised-button>Dataset</button>

        <mat-card *ngIf="selectedFilter === filterTypes.DATASET"
          class="breadcrumb-filter">
          <app-platform-selector
            [platforms]="platforms$ | async"
            [selected]="selectedPlatformName$ | async"
            (removeSelected)="onPlatformRemoved($event)"
            (addSelected)="onPlatformAdded($event)">
          </app-platform-selector>
        </mat-card>
      </div>

      <div class="breadcrumb">
        <button (click)="onNewSelectedFilter(filterTypes.DATE)" mat-raised-button>Date</button>

        <mat-card *ngIf="selectedFilter === filterTypes.DATE"
          class="breadcrumb-filter">
            <app-date-selector
              [startDate]="startDate$ | async"
              [endDate]="endDate$ | async"
              [seasonStart]="seasonStart$ | async"
              [seasonEnd]="seasonEnd$ | async"
              [extrema]="dateRangeExtrema$ | async"
              (newStart)="onNewStartDate($event)"
              (newEnd)="onNewEndDate($event)"
              (newSeasonStart)="onNewSeasonStart($event)"
              (newSeasonEnd)="onNewSeasonEnd($event)">
            </app-date-selector>
        </mat-card>
      </div>
      <div class="breadcrumb">
        <button (click)="onNewSelectedFilter(filterTypes.AOI)" mat-raised-button>Area of Interest</button>

        <mat-card *ngIf="selectedFilter === filterTypes.AOI"
          class="breadcrumb-filter">
            <app-aoi-upload
              (openFileUpload)="onOpenFileDialog()"
              (newDrawMode)="onNewDrawModeType($event)"
              (newInteractionMode)="onNewInteractionMode($event)"
              [drawMode]="drawMode$ | async"
              [interactionMode]="interactionMode$ | async"
              [polygon]="polygon$ | async">
            </app-aoi-upload>
        </mat-card>
      </div>
      <div class="breadcrumb">
        <button (click)="onNewSelectedFilter(filterTypes.PATH_FRAME)" mat-raised-button>Path/Frame</button>

        <mat-card *ngIf="selectedFilter === filterTypes.PATH_FRAME"
          class="breadcrumb-filter">
          <app-path-selector
            (newPathStart)="onNewPathStart($event)"
            (newPathEnd)="onNewPathEnd($event)"
            (newFrameStart)="onNewFrameStart($event)"
            (newFrameEnd)="onNewFrameEnd($event)"
            (newOmitSearchPolygon)="onNewOmitGeoRegion($event)"
            [pathRange]="pathRange$ | async"
            [shouldOmitSearchPolygon]="shouldOmitSearchPolygon$ | async"
            [frameRange]="frameRange$ | async"
            [selected]="selectedPlatforms$ | async">
          </app-path-selector>
        </mat-card>
      </div>
      <div class="breadcrumb">
        <button (click)="onNewSelectedFilter(filterTypes.ADDITIONAL)" mat-raised-button>Additional Filters</button>

        <mat-card *ngIf="selectedFilter === filterTypes.ADDITIONAL"
          class="breadcrumb-filter">
          <app-other-selector
            (newFlightDirections)="onNewFlightDirections($event)"
            (newProductTypes)="onNewProductTypes($event)"
            (newBeamModes)="onNewBeamModes($event)"
            (newPolarizations)="onNewPolarizations($event)"
            [productTypes]="platformProductTypes$ | async"
            [selected]="selectedPlatforms$ | async"
            [flightDirections]="flightDirections$ | async"
            [beamModes]="beamModes$ | async"
            [polarizations]="polarizations$ | async">
          </app-other-selector>
        </mat-card>
      </div>
      <div class="breadcrumb">
        <button (click)="onDoSearch()" style="margin-left: 20px" mat-raised-button color="primary">
          {{ (loading$ | async) ? 'Loading...' : 'Search' }}
        </button>
      </div>
    </div>
  </div>

  <div class="layout">


  <div *ngIf="products" matTooltip="Download Queue">
    <button
      style="background: white"
      class="spacing"
      (click)="onOpenDownloadQueue()"
      [disabled]="products.length <= 0"  color="basic"
      mat-fab>
        <mat-icon
          [matBadge]="products.length" matBadgePosition="below" matBadgeOverlap="false">
            cloud_download
        </mat-icon>
    </button>
  </div>

  <button
    (click)="onAccountButtonClicked()"
    matTooltip="Login"
    class="spacing"
    color="basic"
    mat-fab>
    <mat-icon>{{ datapoolAuthService.isLoggedIn ? 'check_circle' : 'account_circle' }}</mat-icon>
  </button>

  <button
    matTooltip="Share Search"
    class="spacing"
    color="basic"
    [matMenuTriggerFor]="shareMenu"
    mat-fab>
      <mat-icon>share</mat-icon>
  </button>

  <mat-menu #shareMenu="matMenu">
    <button mat-menu-item (click)="onCopy()"
      matSuffix>
      <mat-icon>file_copy</mat-icon>
      <span>Copy Search Link</span>
    </button>
    <a (click)="onShareWithEmail()"
      href="mailto:?subject=&body=:%20" target="_blank"
      title="Send email"
      mat-menu-item matSuffix>
        <mat-icon>email</mat-icon>
        <span>Share With Email</span>
    </a>
  </mat-menu>

  <button
    matTooltip="ASF Apps"
    class="spacing"
    color="basic"
    [matMenuTriggerFor]="appMenu"
    mat-fab>
      <mat-icon>apps</mat-icon>
  </button>
  <mat-menu #appMenu="matMenu">
    <a mat-menu-item [href]="asfWebsiteUrl" target="_blank">
      ASF Website
    </a>
    <a mat-menu-item href="https://baseline.asf.alaska.edu" target="_blank">
      Baseline Tool
    </a>
    <a mat-menu-item href="{{ asfWebsiteUrl }}/get-data/api" target="_blank">
     ASF API
    </a>
    <button mat-menu-item [matMenuTriggerFor]="thematicDatasets">Thematic Datasets</button>
  </mat-menu>

  <mat-menu #thematicDatasets="matMenu">
    <a mat-menu-item href="{{ asfWebsiteUrl }}/other-data/gismo" target="_blank">GISMO</a>
    <a mat-menu-item href="{{ asfWebsiteUrl }}/other-data/glacier-speed" target="_blank">Glacier Speed</a>
    <a mat-menu-item href="{{ asfWebsiteUrl }}/other-data/polar-year-07-08" target="_blank">Polar Year</a>
    <a mat-menu-item href="{{ asfWebsiteUrl }}/other-data/ramp" target="_blank">RAMP</a>
    <a mat-menu-item href="{{ asfWebsiteUrl }}/other-data/sea-ice" target="_blank">Sea Ice MEaSUREs</a>
    <a mat-menu-item href="{{ asfWebsiteUrl }}/wetlands" target="_blank">Wetlands MEaSUREs</a>
  </mat-menu>

  </div>
</div>

